syntax = "proto3";
package auth;

// ======================================
// 🔐 认证相关协议定义文件
// ======================================
// 本文件定义了与用户认证相关的消息协议，包括登录、验证码、在线状态等
// 
// 主要包含：
// 1. DeviceType - 设备类型枚举
// 2. AuthReqMsg - 认证请求消息
// 3. AuthRepMsg - 认证响应消息
// 4. SendVerificationCodeReqMsg - 发送验证码请求
// 5. SendVerificationCodeRepMsg - 发送验证码响应
// 6. OnlineStatusMsg - 用户上线消息
// 7. OfflineStatueMsg - 用户下线消息
// ======================================

// ================================
// 📦 设备类型枚举
// ================================
// 用于标识客户端的来源类型，有助于服务端区分平台特性、限流策略等
enum DeviceType {
  UNKNOWN = 0;
  MOBILE = 1;
  WEB = 3;
  PC = 4;
}
enum AuthType{
  AUTH_TYPE_UNKNOWN = 0;
  AUTH_TYPE_EMAIL = 1;
  AUTH_TYPE_PHONE = 2;
  AUTH_TYPE_USERNAME = 3;
}
// ================================
// 📦 登录
// ================================
// 登录请求
message LoginReqMsg {
  // 当前消息的唯一 ID，用于追踪、ACK 等
  int64 id = 1;
  // 登录方式 邮箱或 电话
  AuthType auth_type = 2;
  // 登录内容 邮箱或/电话
  string auth_content = 3;
  // 密码（明文或加密）
  string password = 4;
  // 登录设备类型（枚举，如 iOS/Android/Web）
  DeviceType device_type = 5;

}
// ================================
// 📦 登录返回
// ================================
// 登录返回
message LoginRespMsg {
  // 当前消息的唯一 ID，用于追踪、ACK 等
  int64 id = 1;
  // 刷新凭证
  string token = 2;
  // 过期时间
  uint64 expires_at = 3;
  // 是否成功
  bool success = 4;
  string msg = 5;
  int64 uid = 6;
  string nickname = 7;
  string avatar = 8;
}

// ========================================
//  退出请求
message LogoutReqMsg {
  // 当前消息的唯一 ID，用于追踪、ACK 等
  int64 id = 1;
}

// 退出返回
message LogoutRespMsg {
  int64 id = 1;
}

// ========================================
// 📩 发送验证码请求
// ========================================
// 客户端请求发送验证码（短信、邮件等）用于登录或注册
message SendVerificationCodeReqMsg {
  // 当前消息的唯一 ID，用于追踪、ACK 等
  int64 id = 1;
  // 接收目标（手机号或邮箱）：验证码发送的目标
  string receiver = 2;
  // 渠道类型（如 sms / email / voice）：验证码发送渠道
  string channel = 3;
  // 场景标识（如 login / register / reset_pwd）：验证码使用场景
  string scene = 4;
  // 客户端 ID 或设备标识（可用于风控）：请求方标识
  int64 uid = 5;
}

// ========================================
// ✅ 发送验证码响应
// ========================================
// 服务端对验证码发送请求的响应
message SendVerificationCodeRepMsg {
  // 与请求一致的 ID：对应请求的消息ID
  int64 id = 1;
  // 是否发送成功：true表示验证码已发送，false表示发送失败
  bool success = 2;
  // 附加消息，如错误提示：详细的响应信息
  string message = 3;
  // 有效期（秒）：验证码的有效期，单位秒
  int64 expired_in = 4;
}

// =======================================
// 🟢 用户上线消息（OnlineStatus）
// =======================================
// 表示某个用户刚刚上线，服务端可用于广播通知。
message OnlineStatusMsg {
  // 当前消息的唯一 ID，用于追踪、ACK 等
  int64 id = 1;
  // 上线用户 ID：上线用户的唯一标识
  int64 uid = 2;
  // 上线设备类型（如 mobile/web/pc）：用户使用的设备类型
  DeviceType device_type = 3;
  // 客户端实例 ID（可用于多端区分）：客户端唯一标识
  int64 client_id = 4;
  // 上线时间戳（毫秒）：用户上线的时间
  int64 login_time = 5;
}

// =======================================
// 🔴 用户下线消息（OfflineStatus）
// =======================================
// 表示某个用户从某设备下线，服务端可用于状态同步或通知。
message OfflineStatueMsg {
  // 当前消息的唯一 ID，用于追踪、ACK 等
  int64 id = 1;
  // 下线用户 ID：下线用户的唯一标识
  string uid = 2;
  // 下线设备类型（如 mobile/web/pc）：用户使用的设备类型
  DeviceType device_type = 3;
  // 客户端实例 ID（可用于多端区分）：客户端唯一标识
  int64 client_id = 4;
  // 下线时间戳（毫秒）：用户下线的时间
  int64 logout_time = 5;
  // 可选：下线原因，如超时、手动退出、被踢等：下线原因说明
  string reason = 6;
}
