syntax = "proto3";
import "google/protobuf/empty.proto";
package message;

// è®¾å¤‡ç±»å‹ï¼šç”¨äºå¤šç«¯ç™»å½•ç­–ç•¥æ§åˆ¶
enum DeviceType {
  UNKNOWN = 0;
  MOBILE = 1;
  WEB = 3;
  PC = 4;
}

// ======================================
// ğŸ˜„ Emoji ç±»å‹å®šä¹‰ï¼ˆæ ‡å‡† + è‡ªå®šä¹‰ï¼‰
// ======================================
// å®šä¹‰äº†ç³»ç»Ÿä¸­æ”¯æŒçš„ emoji ç±»å‹ï¼ŒåŒ…æ‹¬æ ‡å‡† emoji å’Œè‡ªå®šä¹‰è¡¨æƒ…
enum EmojiType {
  EMOJI_UNKNOWN = 0;
  // å¾®ç¬‘è¡¨æƒ…
  SMILE = 1;
  // å’§å˜´ç¬‘è¡¨æƒ…
  GRIN = 2;
  // æµæ³ªè¡¨æƒ…
  TEARS = 3;
  // åèˆŒå¤´è¡¨æƒ…
  STUCK_OUT_TONGUE = 4;
  // é¼“æŒè¡¨æƒ…
  CLAP = 25;
  // ä¾¿ä¾¿è¡¨æƒ…
  POOP = 28;
  // çˆ±å¿ƒè¡¨æƒ…
  HEART = 21;
  // ... å¯ç»§ç»­æ‰©å±•æ ‡å‡† Emoji
  // è‡ªå®šä¹‰è¡¨æƒ…ï¼ˆé€šè¿‡å›¾ç‰‡ URL æŒ‡å®šï¼‰
  CUSTOM_EMOJI = 1000;
}

// é€šè¯åª’ä½“ç±»å‹
enum CallMediaType {
  // è¯­éŸ³
  CALL_AUDIO = 0;
  // è§†é¢‘
  CALL_VIDEO = 1;
}

// é€šè¯ç»“æŸåŸå› 
enum CallEndReason {
  // æœªæŒ‡å®š
  CER_UNSPECIFIED = 0;
  // ä¸»åŠ¨å–æ¶ˆ
  CER_CANCELLED = 1;
  // å¯¹æ–¹æ‹’ç»
  CER_REJECTED = 2;
  // å¯¹æ–¹å¿™
  CER_BUSY = 3;
  // è¶…æ—¶æœªåº”ç­”
  CER_TIMEOUT = 4;
  // æ­£å¸¸æŒ‚æ–­
  CER_HANGUP = 5;
  // å¤±è´¥/å¼‚å¸¸
  CER_FAILED = 6;
}

// é€šè¯å†…ä¿®æ”¹ç±»å‹
enum CallModifyType {
  // æœªæŒ‡å®šï¼Œç”¨ä½œé»˜è®¤å€¼ï¼Œæ»¡è¶³ proto3 é¦–å…ƒç´ ä¸º 0 çš„è¦æ±‚
  CMT_UNSPECIFIED = 0;
  // é™éŸ³/å–æ¶ˆé™éŸ³
  CMT_MUTE = 1;
  // å¼€/å…³æ‘„åƒå¤´
  CMT_CAMERA = 2;
  // ä¿æŒ/æ¢å¤é€šè¯
  CMT_HOLD = 3;
  // åˆ‡æ¢å‰åæ‘„
  CMT_SWITCH_CAMERA = 4;
}
enum ChatScene {
  // é»˜è®¤æœªçŸ¥åœºæ™¯ï¼ˆé˜²å¾¡å€¼ï¼‰
  CHAT_UNKNOWN = 0;
  // å•äººä¼šè¯ï¼šç”¨æˆ·ä¸ç”¨æˆ·ä¹‹é—´çš„ç§èŠ
  SINGLE = 1;
  // ç¾¤èŠä¼šè¯ï¼šç¾¤ç»„å†…çš„å¤šäººèŠå¤©
  GROUP = 2;
  // èµ„æ–™/ç³»ç»Ÿäº‹ä»¶ä¼šè¯
  PROFILE = 3;
}
// ======================================
// ğŸ’  æ¶ˆæ¯å†…å®¹ç»“æ„ï¼ˆoneof ç±»å‹ï¼‰
// ======================================
// ä½¿ç”¨ oneof å®šä¹‰ä¸åŒç±»å‹çš„æ¶ˆæ¯å†…å®¹ï¼Œç¡®ä¿æ¶ˆæ¯ç±»å‹çš„äº’æ–¥æ€§
message MessageContent {
  oneof content {
    // æ–‡æœ¬æ¶ˆæ¯ï¼šçº¯æ–‡æœ¬å†…å®¹
    TextContent text = 1;
    // å›¾ç‰‡æ¶ˆæ¯ï¼šå›¾ç‰‡æ–‡ä»¶
    ImageContent image = 2;
    // éŸ³é¢‘æ¶ˆæ¯ï¼šè¯­éŸ³æˆ–éŸ³ä¹
    AudioContent audio = 3;
    // è§†é¢‘æ¶ˆæ¯ï¼šè§†é¢‘æ–‡ä»¶
    VideoContent video = 4;
    // ä½ç½®æ¶ˆæ¯ï¼šåœ°ç†ä½ç½®ä¿¡æ¯
    LocationContent location = 5;
    // æ–‡ä»¶æ¶ˆæ¯ï¼šä»»æ„æ–‡ä»¶ç±»å‹
    FileContent file = 6;
    // éŸ³è§†é¢‘é€šè¯ä¿¡ä»¤ï¼šé€šè¯æ§åˆ¶æ¶ˆæ¯
    AVCallContent av_call = 7;
    // è‡ªå®šä¹‰æ¶ˆæ¯ï¼šå¼€å‘è€…è‡ªå®šä¹‰ç»“æ„
    CustomContent custom = 8;
    // è¡¨æƒ…æ¶ˆæ¯ï¼šemoji è¡¨æƒ…
    EmojiContent emoji = 9;
    // æ’¤å›æ¶ˆæ¯ï¼šæ¶ˆæ¯æ’¤å›é€šçŸ¥
    RevokeContent revoke = 10;
    // è½¬å‘æ¶ˆæ¯ï¼šæ¶ˆæ¯è½¬å‘
    ForwardContent forward = 11;
    // å¼•ç”¨å›å¤æ¶ˆæ¯ï¼šå›å¤ç‰¹å®šæ¶ˆæ¯
    QuoteContent quote = 12;
    // HTML å¡ç‰‡ï¼šå¯Œæ–‡æœ¬å†…å®¹
    HtmlContent html = 13;
    // VOIP é€šè¯è®°å½•ï¼šé€šè¯æ—¥å¿—
    VoipContent voip = 14;
    // é€šçŸ¥æ¶ˆæ¯ï¼šç³»ç»Ÿé€šçŸ¥
    NotificationContent notification = 15;
    // æé†’æ¶ˆæ¯ï¼šæé†’äº‹é¡¹
    ReminderContent reminder = 17;
    // ç¾¤ç»„äº‹ä»¶ï¼šç¾¤ç»„ç›¸å…³äº‹ä»¶
    GroupEventContent group_event = 18;
    // å¥½å‹äº‹ä»¶ï¼šç”¨äºåŒæ­¥åˆ«å/å¤‡æ³¨å˜æ›´ç­‰
    FriendEventContent friend_event = 24;
    // åç‰‡æ¶ˆæ¯ï¼šè”ç³»äººåˆ†äº«
    ContactCardContent contact_card = 19;
    // æŠ•ç¥¨æ¶ˆæ¯ï¼šæŠ•ç¥¨å†…å®¹
    VoteContent vote = 20;
    // çº¢åŒ…æ¶ˆæ¯ï¼šçº¢åŒ…å†…å®¹
    RedEnvelopeContent red_envelope = 21;
    // åˆ é™¤æ¶ˆæ¯ï¼šç”¨äºé€šçŸ¥å„ç«¯æŸæ¡æ¶ˆæ¯å·²ç»è¢«åˆ é™¤ï¼ˆå¯é€‰å›æ»š/æ’¤å›ï¼‰
    DeleteContent delete = 22;
    // ä¸ªäººä¿¡æ¯æ›´æ–°ï¼šæ˜µç§°/å¤´åƒ/é‚®ç®±/ç”µè¯ç­‰åŒæ­¥
    ProfileEventContent profile_update = 27;
  }
}

// ===============================
// âœ… é€šç”¨ä¸šåŠ¡ç¡®è®¤/é€šçŸ¥ï¼ˆå¤„ç†ç»“æœå›æ‰§ï¼‰
// ===============================
// ç”¨äºæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å›ä¼ â€œè¯¥ä¸šåŠ¡å·²å¤„ç†â€çš„æ ‡å‡†ç»“æ„ã€‚
message AckContent {
  // æ˜¯å¦æˆåŠŸ
  bool ok = 1;
  // ä¸šåŠ¡é”™è¯¯ç ï¼ˆ0 è¡¨ç¤ºæ— é”™è¯¯ï¼‰
  int32 code = 2;
  // æ–‡æœ¬ä¿¡æ¯ï¼ˆå¯æœ¬åœ°åŒ–ï¼‰
  string message = 3;
  // å¯é€‰çš„å¼•ç”¨æ¶ˆæ¯ IDï¼ˆä¸æ­¤æ¬¡å¤„ç†ç›¸å…³çš„æ¶ˆæ¯ï¼‰
  optional uint64 ref_message_id = 5;
  // é™„åŠ æ•°æ®ï¼ˆé¢„ç•™ï¼‰
  bytes extra = 6;
}

// ===============================
// ğŸ—‘ï¸ åˆ é™¤æ¶ˆæ¯
// ===============================
// é€šçŸ¥å„ç«¯æŸæ¡æ¶ˆæ¯å·²ç»è¢«ç§»é™¤ï¼Œå¯ç”¨äºæ’¤å›æˆ–ç”¨æˆ·ä¸»åŠ¨åˆ é™¤
message DeleteContent {
  // è¢«åˆ é™¤çš„æ¶ˆæ¯ IDï¼ˆç”± sender ç”Ÿæˆï¼‰
  uint64 message_id = 1;
  // å‘èµ·åˆ é™¤çš„ç”¨æˆ· ID
  int64 deleted_by = 2;
  // åˆ é™¤äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´
  int64 deleted_at = 3;
  // æ˜¯å¦åŒæ­¥æ‰€æœ‰æˆå‘˜ï¼ˆtrue è¡¨ç¤ºâ€œæ’¤å›â€ï¼Œfalse ä»…åœ¨å½“å‰è®¾å¤‡éšè—ï¼‰
  bool for_everyone = 4;
  // å¯é€‰çš„åˆ é™¤åŸå› ï¼ˆä¾‹å¦‚â€œè¿è§„å†…å®¹â€ï¼‰
  string reason = 5;
}

// ===============================
// ğŸ¤ å¥½å‹ä¸šåŠ¡æ¶ˆæ¯
// ===============================
// å°†ç”³è¯·ä¸å®¡æ ¸ç»„ç»‡åœ¨åŒä¸€ä¸ªä¸šåŠ¡è½½ä½“å†…ï¼Œä¾¿äº socket æ¨é€å’Œå‰ç«¯ç»Ÿä¸€æ¸²æŸ“
message FriendBusinessContent {
  oneof action {
    //å¥½å‹ç”³è¯·ä¿¡æ¯
    FriendRequestPayload request = 1;
    // å¥½å‹ç”³è¯·å¤„ç†ï¼ˆæ¥å—/æ‹’ç»ï¼‰
    FriendRequestDecisionPayload decision = 2;
    // å¥½å‹å…³ç³»å·²å»ºç«‹ï¼ˆåŒæ–¹å‡å·²å†™å…¥å¥½å‹å…³ç³»ï¼‰ï¼Œå®¢æˆ·ç«¯å¯æ®æ­¤å…¥åº“å¥½å‹ã€æ›´æ–°ä¼šè¯æç¤ºã€‚
    FriendEstablishedPayload established = 3;
  }
}

// å¥½å‹å…³ç³»å·²å»ºç«‹çš„æç¤ºï¼Œç”¨äºå®¢æˆ·ç«¯è‡ªåŠ¨æ ‡è®°
message FriendEstablishedPayload {
  // å‚ä¸æ–¹ A çš„ç”¨æˆ· IDï¼ˆä¸ uid_b ç»„æˆå¥½å‹å¯¹ï¼‰
  int64 uid_a = 1;
  // å‚ä¸æ–¹ B çš„ç”¨æˆ· ID
  int64 uid_b = 2;
  // å»ºç«‹å¥½å‹å…³ç³»çš„æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  int64 at_ms = 3;
}

// å¥½å‹ç”³è¯·æ¥æº
enum FriendRequestSource {
  // æœªçŸ¥æ¥æº
  FRS_UNKNOWN = 0;
  // äºŒç»´ç æ·»åŠ 
  FRS_QR_CODE = 1;
  // æ‰‹æœºè”ç³»äºº
  FRS_PHONE_CONTACTS = 2;
  // ç”¨æˆ·IDæ·»åŠ 
  FRS_USER_ID = 3;
  // ç¾¤æˆå‘˜æ·»åŠ 
  FRS_GROUP_MEMBER = 4;
}

// å¥½å‹ç”³è¯·ä¿¡æ¯
message FriendRequestPayload {
  // å”¯ä¸€è¯·æ±‚IDï¼Œç”¨äºè¿½è¸ªå’Œå¹‚ç­‰å¤„ç†
  uint64 request_id = 1;
  // ç”³è¯·å‘èµ·æ–¹UID
  int64 from_uid = 2;
  // ç”³è¯·æ¥æ”¶æ–¹UID
  int64 to_uid = 3;
  // ç”³è¯·ç†ç”±/éªŒè¯ä¿¡æ¯
  string reason = 4;
  // ç”³è¯·æ¥æºï¼ˆå¦‚é€šè¿‡æœç´¢ã€äºŒç»´ç ç­‰ï¼‰
  FriendRequestSource source = 5;
  // ç”³è¯·åˆ›å»ºæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  int64 created_at = 6;
  // ç”³è¯·äººå¡«å†™çš„å¤‡æ³¨ä¿¡æ¯
  string remark = 7;
  // ç”³è¯·äººå¸Œæœ›å±•ç¤ºç»™å¯¹æ–¹çš„æ˜µç§°ï¼ˆå¯ç”¨äºé‚€è¯·å¡ç‰‡ï¼‰
  string nickname = 8;
}

// å¥½å‹ç”³è¯·å¤„ç†ï¼ˆæ¥å—/æ‹’ç»ï¼‰ï¼ŒåŠ å…¥é»˜è®¤æ¶ˆæ¯å­—æ®µä»¥ä¾¿è‡ªåŠ¨ä¸‹å‘æ¬¢è¿/æç¤º
message FriendRequestDecisionPayload {
  uint64 request_id = 1;
  bool accepted = 2;
  string remark = 3;
  int64 decided_at = 4;
  reserved 5;
  reserved 6;
  // å®¡æ‰¹äººå¸Œæœ›å±•ç¤ºç»™ç”³è¯·äººçš„æ˜µç§°/ç§°å‘¼
  string nickname = 7;
}

// ===============================
// ğŸ¤ å¥½å‹äº‹ä»¶
// ===============================
// ç”¨äºåŒæ­¥å¥½å‹åˆ«å/å¤‡æ³¨å˜æ›´ç­‰å…¸å‹äº‹ä»¶
enum FriendEventType {
  FE_UNSPECIFIED = 0;
  // å¥½å‹æ˜µç§°æ›´æ–°ï¼ˆoperator_id ä¸ºå‘èµ·äººï¼‰
  FE_NICKNAME_UPDATED = 1;
  // å¥½å‹å¤‡æ³¨æ›´æ–°
  FE_REMARK_UPDATED = 2;
  // å¥½å‹è¢«æ‹‰é»‘/è§£é™¤é»‘åå•
  FE_BLACKLIST_UPDATED = 3;
}

message FriendEventContent {
  // è§¦å‘äº‹ä»¶çš„ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ operator/å‘èµ·è€…ï¼‰
  int64 operator_id = 1;
  // å…³è”çš„å¥½å‹ IDï¼ˆäº‹ä»¶å¯¹è±¡ï¼‰
  int64 friend_id = 2;
  // äº‹ä»¶ç±»å‹
  FriendEventType type = 3;
  // æ–°æ˜µç§°ï¼ˆå¯é€‰ï¼‰
  optional string nickname = 4;
  // æ–°å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰
  optional string remark = 5;
  // äº‹ä»¶å‘ç”Ÿæ—¶é—´
  int64 at = 6;
  // äº‹ä»¶åŸå› ï¼ˆä¾‹å¦‚â€œå®¢æˆ·ç«¯ä¿®æ”¹â€/â€œå®¡æ‰¹â€ï¼‰
  string reason = 7;
  // å¯æ‰©å±• metadata
  map<string, string> metadata = 8;
}

// ===============================
// ğŸ‘¥ ç¾¤ä¸šåŠ¡æ¶ˆæ¯
// ===============================
// å°†åŠ ç¾¤ç”³è¯·ä¸å®¡æ ¸å°è£…åœ¨åŒä¸€ä¸šåŠ¡è½½ä½“
message GroupBusinessContent {
  oneof action {
    GroupJoinRequestPayload join_request = 1;
    GroupJoinDecisionPayload join_decision = 2;
    GroupCreateContent create = 3;
  }
}

// åŠ ç¾¤ç”³è¯·
message GroupJoinRequestPayload {
  uint64 request_id = 1;
  int64 group_id = 2;
  int64 applicant_id = 3;
  string reason = 4;
  int64 created_at = 5;
  repeated int64 via_member_ids = 6;
}

// åŠ ç¾¤ç”³è¯·å®¡æ‰¹
message GroupJoinDecisionPayload {
  uint64 request_id = 1;
  int64 group_id = 2;
  bool approved = 3;
  int64 decided_at = 4;
  string remark = 5;
  repeated int64 approved_member_ids = 6;
  bool send_default_message = 7;
  string default_message = 8;
}

// ===============================
// ğŸ—ï¸ ç¾¤åˆ›å»º/åˆå§‹åŒ–
// ===============================
message GroupCreationMember {
  int64 member_id = 1;
  optional string nickname = 2;
  optional int32 role = 3;
}

message GroupCreateContent {
  string group_name = 1;
  repeated GroupCreationMember members = 2;
  string notice = 3;
  GroupEventContent event = 5;
}

// ===============================
// ğŸ“„ æ–‡æœ¬æ¶ˆæ¯
// ===============================
// æ”¯æŒçº¯æ–‡æœ¬å’Œå¯Œæ–‡æœ¬æ ¼å¼ï¼ŒåŒ…å«å†…è”å®ä½“ï¼ˆé“¾æ¥ã€@ç”¨æˆ·ã€è¯é¢˜ç­‰ï¼‰
message TextContent {
  // æ–‡æœ¬ä¸»ä½“å†…å®¹ï¼šæ¶ˆæ¯çš„æ–‡æœ¬å†…å®¹
  string text = 1;
  // å¯Œæ–‡æœ¬å®ä½“ï¼Œå¦‚é“¾æ¥/@ç”¨æˆ·/è¯é¢˜ï¼šæ–‡æœ¬ä¸­çš„ç‰¹æ®Šå…ƒç´ 
  repeated InlineEntity entities = 2;
}

// å†…è”å®ä½“ï¼šç”¨äºåœ¨æ–‡æœ¬ä¸­æ ‡è®°ç‰¹æ®Šå…ƒç´ 
message InlineEntity {
  // èµ·å§‹ä½ç½®ï¼ˆUTF-8 å­—ç¬¦ç´¢å¼•ï¼‰ï¼šå®ä½“åœ¨æ–‡æœ¬ä¸­çš„å¼€å§‹ä½ç½®
  int32 start = 1;
  // ç»“æŸä½ç½®ï¼ˆä¸å«ï¼‰ï¼šå®ä½“åœ¨æ–‡æœ¬ä¸­çš„ç»“æŸä½ç½®
  int32 end = 2;
  // ç±»å‹ï¼šlink / mention / hashtagï¼šå®ä½“çš„ç±»å‹
  string type = 3;
  // é™„åŠ å€¼ï¼šURLã€ç”¨æˆ·IDç­‰ï¼šå®ä½“çš„å…·ä½“å€¼
  string value = 4;
}

// ===============================
// ğŸ–¼ï¸ å›¾ç‰‡æ¶ˆæ¯
// ===============================
// åŒ…å«å›¾ç‰‡çš„å®Œæ•´ä¿¡æ¯ï¼Œæ”¯æŒåŸå›¾å’Œç¼©ç•¥å›¾
message ImageContent {
  // åŸå›¾ URLï¼šå›¾ç‰‡çš„å®Œæ•´åœ°å€
  string url = 1;
  // ç¼©ç•¥å›¾ URLï¼šå›¾ç‰‡çš„ç¼©ç•¥å›¾åœ°å€
  string thumbnail_url = 2;
  // å®½åº¦ï¼ˆåƒç´ ï¼‰ï¼šå›¾ç‰‡çš„å®½åº¦
  int32 width = 3;
  // é«˜åº¦ï¼ˆåƒç´ ï¼‰ï¼šå›¾ç‰‡çš„é«˜åº¦
  int32 height = 4;
  // æ ¼å¼ï¼ˆå¦‚ jpg/pngï¼‰ï¼šå›¾ç‰‡çš„æ–‡ä»¶æ ¼å¼
  string format = 5;
  // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼šå›¾ç‰‡æ–‡ä»¶çš„å¤§å°
  int64 size = 6;
}

// ===============================
// ğŸ”Š éŸ³é¢‘æ¶ˆæ¯
// ===============================
// æ”¯æŒè¯­éŸ³èŠå¤©å’ŒéŸ³ä¹æ’­æ”¾ï¼ŒåŒ…å«æ—¶é•¿å’Œæ ¼å¼ä¿¡æ¯
message AudioContent {
  // éŸ³é¢‘æ–‡ä»¶ URLï¼šéŸ³é¢‘æ–‡ä»¶çš„åœ°å€
  string url = 1;
  // æ—¶é•¿ï¼ˆç§’ï¼‰ï¼šéŸ³é¢‘çš„æ’­æ”¾æ—¶é•¿
  int32 duration = 2;
  // æ ¼å¼ï¼šéŸ³é¢‘æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ mp3/wavï¼‰
  string format = 3;
  // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼šéŸ³é¢‘æ–‡ä»¶çš„å¤§å°
  int64 size = 4;
  // æ˜¯å¦è¯­éŸ³ï¼ˆvs éŸ³ä¹ç±»éŸ³é¢‘ï¼‰ï¼štrueè¡¨ç¤ºè¯­éŸ³ï¼Œfalseè¡¨ç¤ºéŸ³ä¹
  bool is_voice = 5;
}

// ===============================
// ğŸï¸ è§†é¢‘æ¶ˆæ¯
// ===============================
// åŒ…å«è§†é¢‘æ–‡ä»¶å’Œå°é¢å›¾ï¼Œæ”¯æŒæ’­æ”¾æ§åˆ¶
message VideoContent {
  // è§†é¢‘æ–‡ä»¶ URLï¼šè§†é¢‘æ–‡ä»¶çš„åœ°å€
  string url = 1;
  // æ—¶é•¿ï¼ˆç§’ï¼‰ï¼šè§†é¢‘çš„æ’­æ”¾æ—¶é•¿
  int32 duration = 2;
  // å°é¢å›¾ URLï¼šè§†é¢‘çš„å°é¢å›¾ç‰‡
  string cover_url = 3;
  // å®½åº¦ï¼ˆåƒç´ ï¼‰ï¼šè§†é¢‘çš„å®½åº¦
  int32 width = 4;
  // é«˜åº¦ï¼ˆåƒç´ ï¼‰ï¼šè§†é¢‘çš„é«˜åº¦
  int32 height = 5;
  // æ ¼å¼ï¼šè§†é¢‘æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ mp4/aviï¼‰
  string format = 6;
  // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼šè§†é¢‘æ–‡ä»¶çš„å¤§å°
  int64 size = 7;
}

// ===============================
// ğŸ“ ä½ç½®æ¶ˆæ¯
// ===============================
// åŒ…å«åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œæ”¯æŒåœ°å€æè¿°å’Œåœ°å›¾æ˜¾ç¤º
message LocationContent {
  // çº¬åº¦ï¼šåœ°ç†ä½ç½®çš„çº¬åº¦åæ ‡
  double latitude = 1;
  // ç»åº¦ï¼šåœ°ç†ä½ç½®çš„ç»åº¦åæ ‡
  double longitude = 2;
  // åœ°å€æè¿°ï¼šä½ç½®çš„æ–‡å­—æè¿°
  string address = 3;
  // åœ°ç‚¹åç§°ï¼šå…·ä½“çš„åœ°ç‚¹åç§°
  string poi_name = 4;
  // ç¼©ç•¥å›¾ URLï¼šä½ç½®çš„åœ°å›¾ç¼©ç•¥å›¾
  string thumbnail_url = 5;
}

// ===============================
// ğŸ“ æ–‡ä»¶æ¶ˆæ¯
// ===============================
// æ”¯æŒä»»æ„æ–‡ä»¶ç±»å‹ï¼ŒåŒ…å«æ–‡ä»¶ä¿¡æ¯å’Œå›¾æ ‡
message FileContent {
  // æ–‡ä»¶ URLï¼šæ–‡ä»¶çš„ä¸‹è½½åœ°å€
  string url = 1;
  // æ–‡ä»¶åï¼šæ–‡ä»¶çš„æ˜¾ç¤ºåç§°
  string name = 2;
  // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼šæ–‡ä»¶çš„å¤§å°
  int64 size = 3;
  // æ–‡ä»¶ç±»å‹ï¼šæ–‡ä»¶çš„ MIME ç±»å‹
  string file_type = 4;
  // å›¾æ ‡ URLï¼šæ–‡ä»¶ç±»å‹çš„å›¾æ ‡
  string icon_url = 5;
}

// ===============================
// ğŸ“ éŸ³è§†é¢‘é€šè¯ä¿¡ä»¤
// ===============================
// ç”¨äºéŸ³è§†é¢‘é€šè¯çš„æ§åˆ¶ä¿¡ä»¤ï¼ŒåŒ…å«é€šè¯çŠ¶æ€å’Œå‚ä¸è€…ä¿¡æ¯
message AVCallContent {
  // é€šè¯ IDï¼šé€šè¯çš„å”¯ä¸€æ ‡è¯†
  string call_id = 1;
  // å‘èµ·è€… IDï¼šé€šè¯çš„å‘èµ·ç”¨æˆ·
  int64 initiator_uid = 2;
  // å‚ä¸è€… ID åˆ—è¡¨ï¼šé€šè¯çš„æ‰€æœ‰å‚ä¸è€…
  repeated int64 participant_ids = 3;
  enum CallAction {
    // æœªçŸ¥æ“ä½œ
    UNKNOWN = 0;
    // é‚€è¯·ï¼šå‘èµ·é€šè¯é‚€è¯·
    INVITE = 1;
    // æ¥å—ï¼šæ¥å—é€šè¯é‚€è¯·
    ACCEPT = 2;
    // æ‹’ç»ï¼šæ‹’ç»é€šè¯é‚€è¯·
    REJECT = 3;
    // å–æ¶ˆï¼šå–æ¶ˆé€šè¯
    CANCEL = 4;
    // ç»“æŸï¼šç»“æŸé€šè¯
    END = 5;
    // è¶…æ—¶ï¼šé€šè¯è¶…æ—¶
    TIMEOUT = 6;
  }
  // é€šè¯æ“ä½œï¼šå…·ä½“çš„é€šè¯åŠ¨ä½œ
  CallAction action = 4;
  enum CallType {
    // éŸ³é¢‘é€šè¯ï¼šä»…è¯­éŸ³é€šè¯
    AUDIO = 0;
    // è§†é¢‘é€šè¯ï¼šéŸ³è§†é¢‘é€šè¯
    VIDEO = 1;
  }
  // é€šè¯ç±»å‹ï¼šé€šè¯çš„ç±»å‹
  CallType type = 5;
  // æ—¶é—´æˆ³ï¼šæ“ä½œçš„æ—¶é—´
  int64 timestamp = 6;
  // æ—¶é•¿ï¼ˆç§’ï¼‰ï¼šé€šè¯çš„æŒç»­æ—¶é—´
  int32 duration = 7;
}

// ===============================
// ğŸ’  è‡ªå®šä¹‰ç»“æ„åŒ–æ¶ˆæ¯
// ===============================
// æ”¯æŒå¼€å‘è€…è‡ªå®šä¹‰çš„æ¶ˆæ¯ç»“æ„ï¼Œé€šå¸¸ä»¥ JSON æ ¼å¼æ‰¿è½½
message CustomContent {
  // è‡ªå®šä¹‰ç±»å‹ï¼šæ¶ˆæ¯çš„è‡ªå®šä¹‰ç±»å‹æ ‡è¯†
  string custom_type = 1;
  // JSON è½½è·ï¼šè‡ªå®šä¹‰æ¶ˆæ¯çš„ JSON æ•°æ®
  string json_payload = 2;
}

// ===============================
// ğŸ˜„ è¡¨æƒ…æ¶ˆæ¯
// ===============================
// æ”¯æŒæ ‡å‡† emoji å’Œè‡ªå®šä¹‰è¡¨æƒ…
message EmojiContent {
  // è¡¨æƒ…ç±»å‹ï¼šæ ‡å‡† emoji ç±»å‹
  EmojiType emoji = 1;
  // è‡ªå®šä¹‰è¡¨æƒ… URLï¼šè‡ªå®šä¹‰è¡¨æƒ…çš„å›¾ç‰‡åœ°å€
  string custom_emoji_url = 2;
}

// ===============================
// â›” æ’¤å›æ¶ˆæ¯
// ===============================
// ç”¨äºé€šçŸ¥æ¶ˆæ¯æ’¤å›ï¼ŒåŒ…å«æ’¤å›çš„ç›®æ ‡æ¶ˆæ¯ä¿¡æ¯
message RevokeContent {
  // ç›®æ ‡æ¶ˆæ¯ IDï¼šè¢«æ’¤å›çš„æ¶ˆæ¯ID
  int64 target_message_id = 1;
  // æ“ä½œè€… IDï¼šæ‰§è¡Œæ’¤å›æ“ä½œçš„ç”¨æˆ·
  int64 operator_id = 2;
  // æ’¤å›æ—¶é—´ï¼šæ’¤å›æ“ä½œçš„æ—¶é—´æˆ³
  int64 revoke_time = 3;
}

// ===============================
// ğŸ“¤ è½¬å‘æ¶ˆæ¯
// ===============================
// ç”¨äºæ¶ˆæ¯è½¬å‘ï¼ŒåŒ…å«åŸæ¶ˆæ¯çš„åŸºæœ¬ä¿¡æ¯
message ForwardContent {
  // åŸæ¶ˆæ¯ IDï¼šè¢«è½¬å‘æ¶ˆæ¯çš„ID
  uint64 original_message_id = 1;
  // åŸå‘é€è€… IDï¼šåŸæ¶ˆæ¯çš„å‘é€è€…
  string original_sender_id = 2;
  // æ‘˜è¦ï¼šè½¬å‘çš„æ‘˜è¦ä¿¡æ¯
  string summary = 4;
}

// ===============================
// ğŸ“Œ å¼•ç”¨å›å¤æ¶ˆæ¯
// ===============================
// ç”¨äºå›å¤ç‰¹å®šæ¶ˆæ¯ï¼ŒåŒ…å«è¢«å¼•ç”¨æ¶ˆæ¯çš„ä¿¡æ¯
message QuoteContent {
  // è¢«å¼•ç”¨æ¶ˆæ¯ IDï¼šè¢«å›å¤æ¶ˆæ¯çš„ID
  uint64 quoted_message_id = 1;
  // è¢«å¼•ç”¨å†…å®¹é¢„è§ˆï¼šè¢«å›å¤æ¶ˆæ¯çš„é¢„è§ˆ
  string quoted_content_preview = 2;
  // å¼•ç”¨æ–‡æœ¬ï¼šå›å¤çš„æ–‡æœ¬å†…å®¹
  string quote_text = 3;
}

// ===============================
// ğŸŒ HTML å¡ç‰‡
// ===============================
// ç”¨äºå¯Œæ–‡æœ¬å†…å®¹ï¼Œæ”¯æŒç½‘é¡µé“¾æ¥å’Œé¢„è§ˆ
message HtmlContent {
  // æ ‡é¢˜ï¼šå¡ç‰‡çš„æ ‡é¢˜
  string title = 1;
  // URLï¼šé“¾æ¥åœ°å€
  string url = 2;
  // é¢„è§ˆï¼šå†…å®¹çš„é¢„è§ˆæ–‡æœ¬
  string preview = 3;
}

// ===============================
// ğŸ“ VOIP é€šè¯è®°å½•
// ===============================
// ç”¨äºè®°å½•é€šè¯å†å²ï¼ŒåŒ…å«é€šè¯çš„åŸºæœ¬ä¿¡æ¯
message VoipContent {
  // ä¸»å« IDï¼šå‘èµ·é€šè¯çš„ç”¨æˆ·
  string caller_id = 1;
  // è¢«å« IDï¼šæ¥æ”¶é€šè¯çš„ç”¨æˆ·
  string callee_id = 2;
  // é€šè¯æ—¶é•¿ï¼ˆç§’ï¼‰ï¼šé€šè¯çš„æŒç»­æ—¶é—´
  int64 duration = 3;
  // é€šè¯çŠ¶æ€ï¼šé€šè¯çš„ç»“æœçŠ¶æ€
  string status = 4;
}

// ===============================
// ğŸ”” é€šçŸ¥æ¶ˆæ¯
// ===============================
// ç”¨äºç³»ç»Ÿé€šçŸ¥ï¼ŒåŒ…å«æ ‡é¢˜ã€å†…å®¹å’Œå…ƒæ•°æ®
message NotificationContent {
  // æ ‡é¢˜ï¼šé€šçŸ¥çš„æ ‡é¢˜
  string title = 1;
  // å†…å®¹ï¼šé€šçŸ¥çš„ä¸»ä½“å†…å®¹
  string body = 2;
  // å…ƒæ•°æ®ï¼šé€šçŸ¥çš„é™„åŠ ä¿¡æ¯
  map<string, string> metadata = 3;
}

message SystemBusinessContent {
  // ç±»å‹ï¼šå…è®¸é¢„å®šä¹‰æšä¸¾ä»¥ä¾¿å®¢æˆ·ç«¯/æœåŠ¡ç«¯ç»Ÿä¸€å¤„ç†
  SystemBusinessType business_type = 1;
  // æ ‡é¢˜
  string title = 2;
  // è¯¦ç»†å†…å®¹ï¼ˆå¯ç”¨ JSON ç­‰ç»“æ„ï¼‰
  string detail = 3;
}

// ç³»ç»Ÿä¸šåŠ¡ç±»å‹æšä¸¾ï¼Œä¾¿äºå„ç«¯é€šè¿‡ä¸šåŠ¡ç»„è¯†åˆ«åœºæ™¯ã€‚
enum SystemBusinessType {
  // é»˜è®¤å€¼ï¼šæœªçŸ¥/æœªåˆ†ç±»
  SYSTEM_BUSINESS_UNKNOWN = 0;
  // é€šç”¨é€šçŸ¥ï¼ˆåŒ…å«ç»´æŠ¤ã€å‘Šè­¦ã€å‡çº§ã€ç­–ç•¥è°ƒæ•´ç­‰ï¼‰
  SYSTEM_BUSINESS_NOTIFICATION = 1;
  // è´¦æˆ·åœ¨å…¶å®ƒè®¾å¤‡/åœ°ç‚¹ä¸Šçº¿ï¼Œè¢«åŠ¨ä¸‹çº¿é€šçŸ¥
  SYSTEM_BUSINESS_PASSIVE_LOGOUT = 5;
  // æˆä¸ºå¥½å‹æˆåŠŸé€šçŸ¥
  SYSTEM_FRIEND_ADD = 6;
}

// ===============================
// â° æé†’äº‹é¡¹
// ===============================
// ç”¨äºæé†’åŠŸèƒ½ï¼ŒåŒ…å«æé†’æ–‡æœ¬å’Œæ—¶é—´
message ReminderContent {
  // æ–‡æœ¬ï¼šæé†’çš„å†…å®¹
  string text = 1;
  // æé†’æ—¶é—´ï¼šæé†’è§¦å‘çš„æ—¶é—´æˆ³
  int64 remind_at = 2;
}

// ä¸ªäººèµ„æ–™äº‹ä»¶è½½ä½“
message ProfileEventContent {
  enum ProfileEventType {
    EVENT_UNKNOWN = 0;
    EVENT_NAME = 1;
    EVENT_AVATAR = 2;
    EVENT_EMAIL = 3;
    EVENT_PHONE = 4;
    EVENT_LOGOUT = 5;
  }
  ProfileEventType event_type = 1;
  string new_value = 2;
  map<string, string> metadata = 3;
}

// ===============================
// ğŸ‘¥ ç¾¤ç»„äº‹ä»¶
// ===============================
// ç”¨äºç¾¤ç»„ç›¸å…³äº‹ä»¶ï¼ŒåŒ…å«ç¾¤ç»„ä¿¡æ¯å’Œæ“ä½œè€…
  message GroupEventContent {
    // ç¾¤ç»„ IDï¼šäº‹ä»¶ç›¸å…³çš„ç¾¤ç»„
    int64 group_id = 1;
    // äº‹ä»¶â€œç±»å‹â€ï¼šæœºå™¨å¯è¯»
    GroupEventType type = 2;
    // æ“ä½œè€… IDï¼ˆç³»ç»Ÿäº‹ä»¶/å®šæ—¶ä»»åŠ¡å¯å¡« 0ï¼‰
    int64 operator_id = 3;
    // äº‹ä»¶å‘ç”Ÿæ—¶é—´ï¼ˆç”¨äºå®¡è®¡/æ’åºï¼‰
    int64 at = 4;
    // ç»Ÿä¸€å¯è§‚æµ‹ï¼šäººç±»å¯è¯»åŸå› ã€ç°åº¦æ ‡è®°ç­‰
    string reason = 6;
    // é™„åŠ  metadataï¼ˆç°åº¦å¼€å…³ã€æ¥æºç«¯ã€å®¢æˆ·ç«¯ç‰ˆæœ¬ç­‰ï¼‰
    map<string, string> metadata = 7;
    // å…³è”çš„ç”³è¯·/æ¶ˆæ¯/å·¥å•ç­‰ï¼ˆå¦‚å®¡æ‰¹ request_idã€å…¬å‘Šæ¶ˆæ¯ idï¼‰
    optional uint64 ref_id = 8;
    // å¹‚ç­‰è¿½è¸ª/é“¾è·¯æ’æŸ¥ï¼ˆå¦‚ ULID/UUIDï¼‰
    string trace_id = 9;

    oneof payload {
      // æˆå‘˜å˜æ›´äº‹ä»¶ï¼ˆå…¥ç¾¤/é€€ç¾¤/è¸¢äºº/é‚€è¯·/å®¡æ‰¹ç­‰ï¼‰
      GroupMemberChanged member_changed = 10;
      // æˆå‘˜è§’è‰²å˜æ›´ï¼ˆå‡é™çº§ã€è½¬è®©ç¾¤ä¸»ç­‰ï¼‰
      GroupRoleChanged role_changed = 11;
      // ç¾¤èµ„æ–™æ›´æ–°ï¼ˆåç§°/å¤´åƒ/æè¿°ç­‰ï¼‰
      GroupInfoUpdated info_updated = 12;
      // æƒé™é…ç½®æ›´æ–°ï¼ˆåŠ ç¾¤ç­–ç•¥ã€é‚€è¯·æƒé™ç­‰ï¼‰
      GroupPermissionUpdated permission_updated = 13;
      // ç¦è¨€å¼€å…³æˆ–æˆå‘˜è¢«ç¦è¨€
      GroupMuteChanged mute_changed = 14;
      // æˆå‘˜è¢«å°ç¦/è§£é™¤å°ç¦
      GroupBanChanged ban_changed = 15;
      // é‚€è¯·é“¾æ¥å˜æ›´
      GroupInviteLinkUpdated invite_link_updated = 16;
      // å…¬å‘Šå†…å®¹å˜æ›´
      GroupAnnouncementUpdated announcement_updated = 17;
      // ç½®é¡¶æ¶ˆæ¯å˜æ›´ï¼ˆæ–°å¢/ç§»é™¤ï¼‰
      GroupPinChanged pin_changed = 18;
      // å…¥ç¾¤/é€€ç¾¤äº‹ä»¶ï¼ˆä»…é¢å¤–åœºæ™¯ï¼‰
      GroupJoinLeave join_leave = 19;
      // è‡ªå®šä¹‰äº‹ä»¶è´Ÿè½½ï¼ˆå¯æ‰©å±•ï¼‰
      GroupCustomEvent custom = 99;
    }
  }

message GroupMemberChanged {
  enum Action {
    ACTION_UNSPECIFIED = 0;
    ACTION_JOINED = 1;
    ACTION_LEFT = 2;
    ACTION_KICKED = 3;
    ACTION_INVITED = 4;
    ACTION_APPROVED = 5;
  }
  Action action = 1;
  int64 member_id = 2;
  string member_nickname = 3;
  int64 occurred_at = 4;
  repeated int64 via_member_ids = 5;
  string note = 6;
}

message GroupRoleChanged {
  enum RoleChangeType {
    ROLE_CHANGE_UNSPECIFIED = 0;
    ROLE_PROMOTED = 1;
    ROLE_DEMOTED = 2;
    OWNER_TRANSFERRED = 3;
  }
  RoleChangeType change_type = 1;
  int64 target_member_id = 2;
  string previous_role = 3;
  string current_role = 4;
}

message GroupInfoUpdated {
  // å˜æ›´å‰ç¾¤åç§°ã€‚
  string previous_name = 1;
  // å˜æ›´åç¾¤åç§°ã€‚
  string current_name = 2;
  // å˜æ›´å‰ç¾¤å¤´åƒ URLã€‚
  string previous_avatar = 3;
  // å˜æ›´åç¾¤å¤´åƒ URLã€‚
  string current_avatar = 4;
  // å˜æ›´å‰ç¾¤ç®€ä»‹/æè¿°ã€‚
  string previous_description = 5;
  // å˜æ›´åç¾¤ç®€ä»‹/æè¿°ã€‚
  string current_description = 6;
}

message GroupPermissionUpdated {
  // å˜æ›´å‰çš„æƒé™é…ç½®ï¼ˆkey/value è¡¨ç¤ºæƒé™é¡¹å’Œå€¼ï¼‰ã€‚
  map<string, string> previous_permissions = 1;
  // å˜æ›´åçš„æƒé™é…ç½®ã€‚
  map<string, string> current_permissions = 2;
}

message GroupMuteChanged {
  // æ˜¯å¦å¼€å¯å…¨å‘˜ç¦è¨€ã€‚
  bool enable_all_mute = 1;
  // é’ˆå¯¹çš„æˆå‘˜ IDï¼ˆè‹¥é’ˆå¯¹ä¸ªäººç¦è¨€ï¼‰ã€‚
  int64 target_member_id = 2;
  // ç¦è¨€ç»“æŸæ—¶é—´ã€‚
  int64 mute_until = 3;
}

message GroupBanChanged {
  // è¢«å°ç¦æˆå‘˜ IDã€‚
  int64 member_id = 1;
  // å°ç¦ç»“æŸæ—¶é—´ã€‚
  int64 banned_until = 2;
  // å°ç¦åŸå› ã€‚
  string reason = 3;
}

message GroupInviteLinkUpdated {
  // é‚€è¯·é“¾æ¥æ˜¯å¦å¯ç”¨ã€‚
  bool enabled = 1;
  // é“¾æ¥åœ°å€ã€‚
  string link = 2;
  // é“¾æ¥åˆ·æ–°æ—¶é—´ã€‚
  int64 refreshed_at = 3;
}

message GroupAnnouncementUpdated {
  // æ¶ˆæ¯ IDï¼ˆå¦‚æœå…¬å‘Šæ¥è‡ªæŸæ¡æ¶ˆæ¯ï¼‰ã€‚
  uint64 message_id = 1;
  // å˜æ›´å‰å†…å®¹ã€‚
  string previous_announcement = 2;
  // å½“å‰å…¬å‘Šå†…å®¹ã€‚
  string current_announcement = 3;
}

message GroupPinChanged {
  // ç½®é¡¶æ¡ç›® IDã€‚
  string pin_id = 1;
  // æ˜¯å¦è¢«ç½®é¡¶ã€‚
  bool pinned = 2;
}

message GroupJoinLeave {
  // æè¿°æˆå‘˜è¿›å…¥/é€€å‡ºç¾¤çš„äº‹ä»¶ç±»å‹ã€‚
  enum MemberEvent {
    // é»˜è®¤å€¼ï¼Œè¡¨ç¤ºæœªæŒ‡å®šå…·ä½“äº‹ä»¶ã€‚
    MEMBER_EVENT_UNSPECIFIED = 0;
    // æˆå‘˜ä¸»åŠ¨ç¦»å¼€ç¾¤ç»„ã€‚
    MEMBER_EVENT_LEFT = 1;
    // æˆå‘˜è¢«ç®¡ç†å‘˜æˆ–ç³»ç»Ÿç§»é™¤ã€‚
    MEMBER_EVENT_REMOVED = 2;
  }
  // äº‹ä»¶ç±»å‹ã€‚
  MemberEvent event = 1;
  // å˜åŠ¨æˆå‘˜ IDã€‚
  int64 member_id = 2;
}

message GroupCustomEvent {
  string label = 1;
  string data = 2;
}

// ===============================
// äº‹ä»¶æšä¸¾
// ===============================
enum GroupEventType {
  GE_UNSPECIFIED = 0;

  // æˆå‘˜ç±»
  GE_MEMBER_JOINED = 1;
  GE_MEMBER_LEFT = 2;
  GE_MEMBER_KICKED = 3;
  GE_MEMBER_INVITED = 4;
  GE_MEMBER_APPROVED = 5;

  // è§’è‰²ç±»
  GE_ROLE_PROMOTED = 10;
  GE_ROLE_DEMOTED = 11;
  GE_OWNER_TRANSFERRED = 12;

  // èµ„æ–™/è®¾ç½®ç±»
  GE_INFO_UPDATED = 20;
  GE_PERMS_UPDATED = 21;
  GE_INVITE_LINK_UPDATED = 22;
  GE_ANNOUNCEMENT_UPDATED = 23;

  // ç®¡æ§ç±»
  GE_MUTE_ON = 30;
  GE_MUTE_OFF = 31;
  GE_MEMBER_MUTED = 32;
  GE_MEMBER_UNMUTED = 33;
  GE_MEMBER_BANNED = 34;
  GE_MEMBER_UNBANNED = 35;

  // æ¶ˆæ¯ç®¡ç†
  GE_PIN_ADDED = 40;
  GE_PIN_REMOVED = 41;

  // å…¶ä»–/æ‰©å±•
  GE_CUSTOM = 1000;
}

// ===============================
// ğŸ“‡ åç‰‡æ¶ˆæ¯
// ===============================
// ç”¨äºåˆ†äº«è”ç³»äººä¿¡æ¯ï¼ŒåŒ…å«ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯
message ContactCardContent {
  // ç›®æ ‡ IDï¼šè¢«åˆ†äº«ç”¨æˆ·çš„ID
  string target_id = 1;
  // æ˜¾ç¤ºåç§°ï¼šç”¨æˆ·çš„æ˜¾ç¤ºåç§°
  string display_name = 2;
  // å¤´åƒ URLï¼šç”¨æˆ·çš„å¤´åƒåœ°å€
  string avatar_url = 3;
  // å¡ç‰‡ç±»å‹ï¼šåç‰‡çš„ç±»å‹ï¼ˆç”¨æˆ·/ç¾¤ç»„ï¼‰
  string card_type = 4;
}

// ===============================
// ğŸ“Š æŠ•ç¥¨æ¶ˆæ¯
// ===============================
// ç”¨äºç¾¤ç»„æŠ•ç¥¨åŠŸèƒ½ï¼ŒåŒ…å«æŠ•ç¥¨é€‰é¡¹å’Œç»“æœ
message VoteContent {
  // ä¸»é¢˜ï¼šæŠ•ç¥¨çš„ä¸»é¢˜
  string topic = 1;
  // é€‰é¡¹ï¼šæŠ•ç¥¨çš„é€‰é¡¹åˆ—è¡¨
  repeated string options = 2;
  // ç»“æœï¼šæŠ•ç¥¨ç»“æœç»Ÿè®¡
  map<string, int32> result = 3;
  // å¤šé€‰ï¼šæ˜¯å¦å…è®¸å¤šé€‰
  bool multi_choice = 4;
}

// ===============================
// ğŸ’° çº¢åŒ…æ¶ˆæ¯
// ===============================
// ç”¨äºçº¢åŒ…åŠŸèƒ½ï¼ŒåŒ…å«çº¢åŒ…é‡‘é¢å’ŒçŠ¶æ€
message RedEnvelopeContent {
  // å‘é€è€… IDï¼šçº¢åŒ…å‘é€è€…
  int64 sender_id = 1;
  // é‡‘é¢ï¼šçº¢åŒ…é‡‘é¢ï¼ˆåˆ†ï¼‰
  int32 amount = 2;
  // ç¥ç¦è¯­ï¼šçº¢åŒ…çš„ç¥ç¦è¯­
  string blessing = 3;
  // æ˜¯å¦å·²é¢†å–ï¼šçº¢åŒ…æ˜¯å¦å·²è¢«é¢†å–
  bool claimed = 4;
}

// ======================================
// ğŸ“¨ é¡¶å±‚æ¶ˆæ¯ç»“æ„
// ======================================
// å®šä¹‰äº†æ¶ˆæ¯çš„åŸºæœ¬æ¡†æ¶ï¼ŒåŒ…å«å‘é€è€…ã€æ¥æ”¶è€…ã€æ—¶é—´ç­‰å…ƒæ•°æ®
message Content {
  // å”¯ä¸€æ¶ˆæ¯ IDï¼ˆå®¢æˆ·ç«¯ç”Ÿæˆæˆ–æœåŠ¡ç«¯è¡¥å…¨ï¼‰ï¼šæ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†
  optional uint64 message_id = 1;
  // æ¶ˆæ¯å‘é€æ–¹ï¼šå‘é€æ¶ˆæ¯çš„ç”¨æˆ·ID
  int64 sender_id = 2;
  // æ¶ˆæ¯æ¥æ”¶æ–¹ï¼ˆå•èŠä¸ºå¯¹æ–¹ IDï¼Œç¾¤èŠä¸ºç¾¤ IDï¼‰ï¼šæ¥æ”¶æ¶ˆæ¯çš„ç›®æ ‡
  int64 receiver_id = 3;
  // æ¶ˆæ¯å‘é€æ—¶é—´ï¼ˆæ¯«ç§’æ—¶é—´æˆ³ï¼‰ï¼šæ¶ˆæ¯åˆ›å»ºçš„æ—¶é—´
  int64 timestamp = 4;

  // æ¶ˆæ¯æ‰€å±ä¼šè¯ç±»å‹ï¼ˆå•èŠ/ç¾¤èŠï¼‰ï¼šæ¶ˆæ¯çš„ä¼šè¯åœºæ™¯
  ChatScene scene = 6;

  // å¤šæ®µå¤åˆå†…å®¹ï¼ˆå¦‚æ–‡æœ¬ + å›¾ç‰‡ï¼‰ï¼šæ¶ˆæ¯çš„å…·ä½“å†…å®¹
  repeated MessageContent contents = 10;
  // å¥½å‹ç”³è¯·/å—ç†ä¸šåŠ¡è½½è·ï¼ˆé¡¶å±‚ç›´æ¥è¡¨å¾ï¼‰
  FriendBusinessContent friend_business = 11;
  // ç¾¤ç”³è¯·/å—ç†ä¸šåŠ¡è½½è·
  GroupBusinessContent group_business = 12;
  // æ ‡è®°ï¼šè¡¨ç¤ºè¯¥å¸§ä»…ç”¨äºè¿æ¥ä¿æ´»ï¼ˆå¿ƒè·³ï¼‰
  optional bool heartbeat = 13;
  // é€šç”¨ä¸šåŠ¡ç¡®è®¤/é€šçŸ¥ï¼ˆå¤„ç†ç»“æœå›æ‰§ï¼‰
  AckContent ack = 23;
  // ç³»ç»Ÿä¸šåŠ¡é€šçŸ¥ï¼šå¯æ‰¿è½½ç³»ç»Ÿäº‹ä»¶/ä»»åŠ¡æ‰§è¡Œç»“æœ
  SystemBusinessContent system_business = 25;
}



// æ¶ˆæ¯æ‰€å±å¤§ç±»ï¼šå¥½å‹ã€ç¾¤ã€ç³»ç»Ÿæˆ–æœªçŸ¥ã€‚
enum MsgCategory {
  // é»˜è®¤å€¼ï¼šæœªçŸ¥/æœªåˆ†ç±»æ¶ˆæ¯ã€‚
  MSG_CATEGORY_UNKNOWN = 0;
  // å¥½å‹ç›¸å…³æ¶ˆæ¯ã€‚
  MSG_CATEGORY_FRIEND = 1;
  // ç¾¤èŠç›¸å…³æ¶ˆæ¯ã€‚
  MSG_CATEGORY_GROUP = 2;
  // ç³»ç»Ÿ/é€šç”¨é€šçŸ¥ã€‚
  MSG_CATEGORY_SYSTEM = 3;
}

// æŠ•é€’é…ç½®ï¼šæ˜¯å¦éœ€è¦ ACKã€è¿‡æœŸæ—¶é—´ä¸æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚ç”Ÿäº§ç«¯æ§åˆ¶ï¼Œæ¶ˆè´¹ç«¯æŒ‰æ­¤ç­–ç•¥ ACKã€‚
message DeliveryOptions {
  // æ˜¯å¦éœ€è¦å®¢æˆ·ç«¯ ACKï¼štrue æ—¶æ”¶åˆ° socket ACK æ‰æäº¤ Kafka offsetã€‚
  bool require_ack = 1;
  // æ¶ˆæ¯è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¶…è¿‡åå¯ä¸¢å¼ƒ/ä¸å†é‡è¯•ã€‚
  optional uint64 expire_ms = 2;
  // æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œè¶…å‡ºåè§†ä¸ºå¤±è´¥å¹¶æäº¤ offsetã€‚
  optional uint32 max_retry = 3;
}

// ä¸‹è¡Œæ¶ˆæ¯ç»Ÿä¸€åŒ…è£¹ï¼šKafka â†’ Socket çš„è½½ä½“ï¼Œå…¼å®¹å¥½å‹/ç¾¤/ç³»ç»Ÿæ¶ˆæ¯ä¸ä¸šåŠ¡äº‹ä»¶ã€‚
message DomainMessage {
  // æ¶ˆæ¯å”¯ä¸€ IDï¼ˆé›ªèŠ±ï¼‰ï¼›ç¼ºçœæ—¶ç”±æ¶ˆè´¹ç«¯ç”¨å½“å‰æ¯«ç§’å…œåº•ï¼Œç¡®ä¿ ACK å¯¹é½ã€‚
  optional uint64 message_id = 1;
  // å‘é€è€… UIDï¼ˆç³»ç»Ÿæˆ–å…·ä½“ç”¨æˆ·ï¼‰ã€‚
  int64 sender_id = 2;
  // æ¥æ”¶è€… UIDï¼ˆæˆ–ç¾¤å‘åœºæ™¯çš„ç›®æ ‡ UID/GIDï¼‰ã€‚
  int64 receiver_id = 3;
  // ä¸šåŠ¡æ—¶é—´ï¼ˆç§’çº§ï¼Œå…¼å®¹æ—§å­—æ®µï¼‰ã€‚
  int64 timestamp = 4;
  // ç²¾ç¡®æ¯«ç§’æ—¶é—´ï¼Œä¼˜å…ˆä½¿ç”¨ã€‚
  int64 ts_ms = 5;
  // æŠ•é€’ç­–ç•¥ï¼šACK/è¿‡æœŸ/é‡è¯•ã€‚
  DeliveryOptions delivery = 6;
  // åœºæ™¯ï¼šå•èŠ/ç¾¤èŠ/ç³»ç»Ÿã€‚
  ChatScene scene = 7;
  // æ¶ˆæ¯å¤§ç±»ï¼šå¥½å‹/ç¾¤/ç³»ç»Ÿã€‚
  MsgCategory category = 8;
  // å…·ä½“å†…å®¹åˆ—è¡¨ã€‚
  repeated MessageContent contents = 9;
  // å¥½å‹ä¸šåŠ¡è½½è·ï¼ˆè¯·æ±‚/åŒæ„ç­‰ï¼‰ã€‚
  FriendBusinessContent friend_business = 10;
  // ç¾¤ä¸šåŠ¡è½½è·ï¼ˆå…¥ç¾¤/å®¡æ‰¹ç­‰ï¼‰ã€‚
  GroupBusinessContent group_business = 11;
  // ç³»ç»Ÿä¸šåŠ¡è½½è·ï¼ˆå…¬å‘Š/åœæœºç­‰ï¼‰ã€‚
  SystemBusinessContent system_business = 12;
}

// =====================
// è¯­éŸ³/è§†é¢‘é€šè¯ä¿¡ä»¤ï¼ˆMK_FRIEND_CALL_*ï¼‰
// =====================

// å‘èµ·å‘¼å«ï¼ˆå¸¦ SDP offerï¼‰
message CallInvite {
  // é€šè¯IDï¼ˆå…¨å±€å”¯ä¸€å­—ç¬¦ä¸²/é›ªèŠ±ï¼‰
  string call_id = 1;
  // ä¸»å«UID
  int64 from_uid = 2;
  // è¢«å«UID
  int64 to_uid = 3;
  // åª’ä½“ç±»å‹ï¼ˆè¯­éŸ³/è§†é¢‘ï¼‰
  CallMediaType media_type = 4;
  // SDP offerï¼ˆè‹¥ä½¿ç”¨ WebRTCï¼‰
  string sdp_offer = 5;
  // æ‰©å±•å­—æ®µ
  optional string ext = 6;
  // å‘èµ·æ—¶é—´
  uint64 created_at = 7;
}

// å–æ¶ˆå‘¼å«ï¼ˆæŒ¯é“ƒé˜¶æ®µï¼‰
message CallCancel {
  // é€šè¯ID
  string call_id = 1;
  // æ“ä½œè€…UID
  int64 operator_uid = 2;
  // åŸå› ï¼ˆå¯é€‰ï¼‰
  optional string reason = 3;
  // æ—¶é—´
  uint64 at = 4;
}

// æ‹’ç»å‘¼å«
message CallReject {
  // é€šè¯ID
  string call_id = 1;
  // æ‹’ç»è€…UID
  int64 reject_uid = 2;
  // åŸå› ï¼ˆå¯é€‰ï¼‰
  optional string reason = 3;
  // æ—¶é—´
  uint64 at = 4;
}

// æ¥å—å‘¼å«ï¼ˆå¸¦ SDP answerï¼‰
message CallAccept {
  // é€šè¯ID
  string call_id = 1;
  // æ¥å—è€…UID
  int64 accept_uid = 2;
  // SDP answerï¼ˆè‹¥ä½¿ç”¨ WebRTCï¼‰
  string sdp_answer = 3;
  // æ—¶é—´
  uint64 at = 4;
}

// é€šè¯ç»“æŸ/æŒ‚æ–­
message CallHangup {
  // é€šè¯ID
  string call_id = 1;
  // æ“ä½œè€…UID
  int64 operator_uid = 2;
  // ç»“æŸåŸå› 
  CallEndReason reason = 3;
  // é€šè¯æ—¶é•¿ï¼ˆæ¯«ç§’ï¼Œå¯é€‰ï¼‰
  optional uint64 duration_ms = 4;
  // æ—¶é—´
  uint64 at = 5;
}

// é€šè¯ä¸­ä¿®æ”¹ï¼ˆé™éŸ³/å¼€å…³æ‘„åƒå¤´ç­‰ï¼‰
message CallModify {
  // é€šè¯ID
  string call_id = 1;
  // æ“ä½œè€…UID
  int64 operator_uid = 2;
  // ä¿®æ”¹ç±»å‹
  CallModifyType modify = 3;
  // å¼€å…³å€¼ï¼ˆtrue=å¼€/å¯ç”¨ï¼Œfalse=å…³/ç¦ç”¨ï¼‰
  bool on = 4;
  // æ—¶é—´
  uint64 at = 5;
}

// DTMF ä¿¡ä»¤
message CallDtmf {
  // é€šè¯ID
  string call_id = 1;
  // å‘é€è€…UID
  int64 from_uid = 2;
  // DTMF æŒ‰é”®åºåˆ—ï¼ˆå¦‚ "123#*")
  string digits = 3;
  // æ—¶é—´
  uint64 at = 4;
}

// ===============
// æ¶ˆæ¯çŠ¶æ€/æ“ä½œæ¨¡å‹
// ===============

// é€è¾¾å›æ‰§ç¡®è®¤ï¼ˆå®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ï¼šæ”¶åˆ° deliveredï¼‰
message MsgDeliveredAck {
  int64 msg_id = 1; // æ¶ˆæ¯ID
  int64 ack_uid = 2; // ç¡®è®¤è€…UID
  int64 ack_at = 3;
}

// å·²è¯»ä¸ŠæŠ¥ï¼ˆå®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ï¼‰
message MsgRead {
  int64 msg_id = 1;
  int64 uid = 2;
  int64 chat_id = 3; // å•èŠï¼šå¯¹æ–¹IDï¼›ç¾¤èŠï¼šç¾¤ID
  int64 read_at = 4;
}

// å·²è¯»å›æ‰§ç¡®è®¤ï¼ˆæœåŠ¡ç«¯â†’å®¢æˆ·ç«¯ï¼šæ”¶åˆ° readï¼‰
message MsgReadAck {
  int64 msg_id = 1; // æ¶ˆæ¯ID
  int64 ack_uid = 2; // ç¡®è®¤è€…UID
  int64 ack_at = 3;
}

// æ¶ˆæ¯æ’¤å›
message MsgRecall {
  int64 msg_id = 1;
  int64 operator_uid = 2;
  optional string reason = 3;
  int64 recalled_at = 4;
}

// æ¶ˆæ¯è½¬å‘
message MsgForward {
  int64 src_msg_id = 1;
  optional int64 new_msg_id = 2;
  int64 from_uid = 3;
  int64 to_uid = 4;
  int64 created_at = 5;
}

// Reaction æ“ä½œ
enum ReactionAction {
  // æœªæŒ‡å®šåŠ¨ä½œ
  RA_UNKNOWN = 0;
  RA_ADD = 1;
  RA_REMOVE = 2;
}

// æ¶ˆæ¯è¡¨æ€ï¼ˆemoji/reactionï¼‰
message MsgReaction {
  int64 msg_id = 1;
  int64 uid = 2;
  ReactionAction action = 3;
  string emoji = 4;
  int64 at = 5;
}

// æ­£åœ¨è¾“å…¥çŠ¶æ€
enum TypingState {
  TYPING_NONE = 0;
  TYPING_TEXT = 1;
  TYPING_VOICE = 2;
  TYPING_UPLOAD = 3;
}

// æ­£åœ¨è¾“å…¥
message Typing {
  int64 from_uid = 1;
  TypingState state = 3;
  int64 at = 4;

  oneof target {
    int64 to_uid = 2;
    int64 group_id = 5;
  }

  repeated int64 notify_uids = 6;
}

// =====================
// å†å²æ¶ˆæ¯æ£€ç´¢è¯·æ±‚/å“åº”
// =====================

// æŸ¥è¯¢å¥½å‹æ¶ˆæ¯å†å²
message QueryFriendMessagesRequest {
  // å½“å‰ç”¨æˆ· ID
  int64 uid = 1;
  // å¥½å‹ ID
  int64 friend_id = 2;
  // åˆ†é¡µæ¸¸æ ‡ï¼šæ¶ˆæ¯ ID ä¸Šé™ï¼ˆä¸å«ï¼‰
  optional uint64 before_message_id = 3;
  // åˆ†é¡µæ¸¸æ ‡ï¼šæ—¶é—´ä¸Šé™ï¼ˆæ¯«ç§’ï¼Œä¸å«ï¼‰
  optional int64 before_timestamp = 4;
  // è¿”å›æ¡ç›®ä¸Šé™ï¼Œç¼ºçœ 20
  uint32 limit = 5;
}

// æŸ¥è¯¢ç¾¤èŠæ¶ˆæ¯å†å²
message QueryGroupMessagesRequest {
  // ç¾¤ ID
  int64 group_id = 1;
  // åˆ†é¡µæ¸¸æ ‡ï¼šæ¶ˆæ¯ ID ä¸Šé™ï¼ˆä¸å«ï¼‰
  optional uint64 before_message_id = 2;
  // åˆ†é¡µæ¸¸æ ‡ï¼šæ—¶é—´ä¸Šé™ï¼ˆæ¯«ç§’ï¼Œä¸å«ï¼‰
  optional int64 before_timestamp = 3;
  // è¿”å›æ¡ç›®ä¸Šé™ï¼Œç¼ºçœ 20
  uint32 limit = 4;
}

// å†å²æ¶ˆæ¯æŸ¥è¯¢ç»Ÿä¸€å“åº”
message QueryMessagesResponse {
  // æ¶ˆæ¯åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´å€’åºæˆ–åº”ç”¨çº¦å®šæ’åºï¼‰
  repeated Content messages = 1;
  // æ˜¯å¦è¿˜æœ‰æ›´å¤šæ•°æ®
  bool has_more = 2;
}
